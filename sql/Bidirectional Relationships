SELECT 
        PCR.PERSON_ID,
        PAPF.EMPLOYEE_NUMBER,
        PCR.CONTACT_PERSON_ID,
        PCR.CONTACT_TYPE,
        LKUP.MEANING,
        PCR.DATE_START,
        PCR.DATE_END,
        PCR.PRIMARY_CONTACT_FLAG,
        PCR.PERSONAL_FLAG,
        PCR.DEPENDENT_FLAG,
        PCR.RLTD_PER_RSDS_W_DSGNTR_FLAG,
        THIRD_PARTY_PAY_FLAG,
        BONDHOLDER_FLAG,
        BENEFICIARY_FLAG
FROM DQ_PER_CONTACT_RELATIONSHIPS_V PCR
LEFT JOIN APPS.PER_ALL_PEOPLE_F PAPF ON PAPF.PERSON_ID = PCR.PERSON_ID AND TRUNC(SYSDATE) BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
LEFT JOIN APPS.FND_LOOKUP_VALUES LKUP ON LKUP.LOOKUP_CODE = PCR.CONTACT_TYPE 
                                      AND LKUP.LOOKUP_TYPE = 'CONTACT'
                                      AND LKUP.ZD_EDITION_NAME = 'SET1'
WHERE 
    EXISTS (SELECT 1 FROM DQ_CLEANSE_RESULTS R
            WHERE R.START_VALUE = PCR.PERSON_ID
            AND PROCEDURE_NAME = 'DQ_EXISTS'
            AND FIELD_NAME = 'DQ_PERSON_ID'
            AND BATCH_SEQ = (SELECT MAX(BATCH_SEQ) FROM DQ_CLEANSE_RESULTS WHERE DOMAIN_NAME = 'HR')
);
